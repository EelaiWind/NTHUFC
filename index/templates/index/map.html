<!DOCTYPE HTML>
{% extends "index/base.html" %}
{% load static %}

{% block title_name %}
	<title>秘境地圖</title>
{% endblock title_name %}

{% block import_source %}
	<link href="{% static 'css/styles.css' %}" rel="stylesheet" type="text/css">
	<script src="{% static 'js/gallery.js' %}" ></script>
	<script src="{% static 'js/fb_post_like.js' %}" ></script>
	<script src="{% static 'js/map.js' %}" ></script>
{% endblock import_source %}

{% block body_block %}

	<style>
		#map-container {
		    width: 40%;
		    height: 100%;
		    position: fixed;
		    margin-left:650px;
		}

		#google_map{
			position:fixed;
		    width:60%;
		    height:500px;
		    display: block;
		    margin-top:5px;
		}
	</style>

	<script>
		initGallery();
	</script>


    <div class='container'>
	    <center>
	      <h1>搜尋內容: {{ query }}</h1>
	  		{% if photos.count == 0 %}
	        	<h1>查無資料</h1>
	      	{% endif %}
	      <h3 id="show_tag">目前Tag:</h3>
	      <h3 id="show_marker">目前Map Marker: </h3>
	    </center>
	    <div class="row">
	    	<span>標籤：</span><span class = 'btn btn-default btn-xs' style="cursor:pointer; border-radius:4px;" onclick="cancel_filter();">&nbsp;全部</span>
	    	{% for key, value in tagdic.items %}
	    		<span class = 'btn btn-default btn-xs' style="cursor:pointer; border-radius:4px;" title="一共有{{value}}張照片" onclick="filter_photos2('{{key}}');">&nbsp;{{ key }}</span>
	    	{% endfor %}
	    	<button onclick="cancel_filter();">Cancel Filter</button>
	    </div>

	    <div class="row">
	      	<div class="col-md-7">
	      	{% for photo in photos %}
		        <div id="{{ photo.facebook_post_id }}" class="col-xs-offset-1 col-sm-offset-0 col-xs-10 col-sm-6 col-md-6 image_frame">
			        <div class="hovereffect">
			            <img class='gallery' src="{{photo.flickr_photo_url}}" alt="" onload="render_image($(this))">
			            <div class="overlay">
			              	<h2><font>{{ photo.votes }}</font>票</h2>
			              	<p class="icon-links">
			                <a style="cursor:pointer;" onclick="getPhotoDetails('{{photo.facebook_post_id}}')">
			                  	<span class="fa fa-info-circle hover-green"></span>
			                </a>
			                <a href="https://www.flickr.com/photos/138506275@N05/{{photo.flickr_photo_id}}/in/dateposted-public/"  target="_flickr">
			                  	<span class="fa fa-flickr hover-pink"></span>
			                </a>
			                <a style="cursor:pointer;" onclick="postLike_btn('{{photo.facebook_post_id}}')">
			                  	<span class="fa fa-thumbs-up hover-blue"></span>
			                </a>
			                </p>
			            </div>
		            </div>
		        </div>
		      {% endfor %}
		      </div>
		      <div class="col-md-5" id="map-container">
	        	<div id="google_map">
	        	</div>
	      	  </div>
		</div>
	</div>

	<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAl62RoU1i9n0MzNAmw8fcKGTVPryxNJLM&callback=initMap_1">
	</script>

	<script type="text/javascript">
		var marker_list = []
		{% for marker in marker_list %}
			marker_list.push({'title': '{{marker.title}}', 'lat': {{marker.latitude}}, 'lng': {{marker.longitude}} })
		{% endfor %}
		initMarker(marker_list)

		var marker_count = []
		{% for key, value in markerdic.items %}
			marker_count.push({'title': '{{key}}', 'count': {{value}} })
		{% endfor %}
		initMarkerCount(marker_count)

		var photo_list = []
		{% for photo in photos %}
			photo_list.push({'title': '{{photo.title}}', 'content': '{{photo.content}}', 'tags': '{{photo.tags}}', 'fbID': '{{photo.facebook_post_id}}', 'location': '{{photo.location_marker.title}}'})
		{% endfor %}

	</script>

	{% include "photos/modal.html" %}
{% endblock body_block %}
